<!DOCTYPE html>
<html>

<head>
  <script src="js/script.js"></script>
  <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>-->
  <script src="https://code.jquery.com/jquery-3.6.3.js" integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
    crossorigin="anonymous"></script>
  <style>
    body {
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
      padding: 2%;
    }
  </style>
  <title>Bar Chart Maker</title>
</head>

<body>
  <header>
    <h1>Bar Chart Generator</h1>
  </header>

  <p class="chart">

  </p>

  <script>

    //User Input

    var data = [1, 2, 3, 4, 5];

    options = {
      //Title//
      titleName: "Title",
      titleFontSize: "40px",
      titleFontColour: "black",
      //Labels//
      labels: ["a", "b", "c", "d", "e"],
      labelColour: ["tomato", "orange", "dodgerblue", "yellow", "black"],
      //Bar//
      barColour: ["tomato", "orange", "dodgerblue", "yellow", "black"],
      barSpacing: "10%",
      //Axes//
      yTitle: "Units",
      xTitle: "X-Axis",

      //Value Position inside bar (top, bottom, or center)
      valuePos: "0%"
    };

    var element = ".chart";

    function drawBarChart(data, options, element) {

      //Chart type
      if (typeof data[0] === 'number') {
        options.chartType = "Single";
      } else if (typeof data[0] === 'object') {
        options.chartType = "Stacked";
      } else {
        options.chartType = "Invalid Data";
        alert("Invalid data");
      }

      ///Rendering////

      /////Y-Axis
      var yTicks = function (data) {
        var yTicks = ['0_'];
        var ticks = 0;

        // MaxValue -- add functionality to determine any negative numbers and max value under one
        var maxValue = 0;
        if (options.chartType === 'Single') {
          maxValue = Math.max.apply(null, data);
        } else if (options.chartType === 'Stacked') {
          for (i = 0; i < data.length; i++) {
            for (j = 0; j < data[i].length; j++) {
              if (data[i][j] > maxValue) {
                maxValue = data[i][j];
              }
            }
          }
        } options.maxValue = maxValue;

        // Y Axis Ticks - 5 ticks
        for (i = 0; i < 5; i++) {
          ticks += Math.ceil(0.20 * options.maxValue);
          yTicks.unshift((ticks + "-<br><br><br><br>"));
        }
        yTicks = yTicks.join("");
        options.maxYValue = ticks;
        options.yTicks = yTicks;
        return (yTicks);
      };

      // X-Axis
      var xAxisCssGrid = function (data) {
        var xAxisHtml = "";
        var xAxisCount = 0;
        if (options.chartType === 'Single') {
          for (i = 0; i < data.length; i++) {
            xAxisCount++;
            xAxisHtml += "auto ";
          }
        } else if (options.chartType === 'Stacked') {
          for (i = 0; i < data.length; i++) {
            for (j = 0; j < data[i].length; j++) {
              xAxisCount++;
              xAxisHtml += "auto ";
            }
          }
        }
        options.xCount = xAxisCount;
        options.xAxisHtml = xAxisHtml;
        return xAxisHtml;
      };

      //Labels Html 


      ////Jquery Dom Manipulation plus css

      // barChart container 
      var barChart = $('<div>')
        .addClass('barChart')
        .css({
          'display': 'grid',
          'grid-template-columns': 'auto auto auto auto auto',
          'grid-gap': '0px',
          'padding': '5%',
          'background-color': 'white',
          'height': '80%',
          'width': '80%',
          'font-family': 'inherit'
        });

      // Title
      var title = $('<div>')
        .addClass('title')
        .text(options.titleName)
        .css({
          'grid-area': '1/1/span 1/span 11',
          'text-align': 'center',
          'font-size': `${options.titleFontSize}`,
          'color': `${options.titleFontColour}`
        });


      // Y-Axis, Y Title, Ticks
      var yAxis = $('<div>')
        .addClass('yAxis')
        .css({
          'position': 'relative',
          'grid-area': '2/1/span 10 /span 1',
          'text-align': 'right'
        });

      var yTitle = $('<div>')
        .addClass('yTitle')
        .text(options.yTitle)
        .css({
          'text-align': 'center'
        });

      var yTicks = $('<div>')
        .addClass('yTicks')
        .html(yTicks(data))
        .css({
          'position': 'relative',
          'right': '0',
          'bottom': '0%'
        });

      yAxis.append(yTitle, yTicks);

      // X-Axis, Labels, Title) create the x-axis element and its child elements -- need to make function to generate labels
      var xAxis = $('<div>')
        .addClass('xAxis')
        .css({
          "position": "relative",
          "grid-area": "12/2/span 2 /span 10",
          "text-align": "center",
          "display": "grid",
          "grid-template-columns": xAxisCssGrid(data),
          "grid-template-rows": "auto auto",
          "grid-gap": options.barSpacing,
          "padding-left": "10%",
          "padding-right": "10%"
        })

      // Labels
      for (i = 0; i < options.labels.length; i++) {
        xAxis.append($('<div>')
          .addClass("label" + (i + 1))
          .text(options.labels[i])
          .css({
            "position": "center",
            "color": options.labelColour[i]
          })
        )
      }

      var xTitle = $('<div>')
        .addClass('xTitle')
        .text(options.xTitle)
        .css({
          "background-color": "white",
          "grid-area": "2/1/span 2/span 3",//adjust grid area as function
          "position": "center"
        })

      xAxis.append(xTitle);

      // Chart Area (Bars and Values) create the chart area element and its child elements  -- need to make function to generate number of bars and values
      var chartArea = $('<div>').addClass('chartArea').css({
        "position": "relative",
        "grid-area": "2/2/span 10/span 10",
        "grid-gap": options.barSpacing,
        "padding-left": "10%",
        "padding-right": "10%",
        "background-color": "whitesmoke",
        "border-style": "none none groove groove",
        "display": "grid",
        "grid-template-columns": xAxisCssGrid(data)
      });

      var bar1 = $('<div>').addClass('bar1').css({
        "position": "absolute",
        "bottom": "0",
        "grid-area": "1/1/span 1/span 1",
        "background-color": "tomato",

        "text-align": "center",
        "height": "20%",
        "width": "100%",
      });
      var value1 = $('<p>').addClass('value1').text('Value1').css({
        "display": "flexbox",
        "position": "relative",
        "top": "0%",
        "transform": "translateY(-50%)",
      });
      bar1.append(value1);

      var bar2 = $('<div>').addClass('bar2').css({
        "position": "absolute",
        "bottom": "0",
        "grid-area": "1/2/span 1/span 1",
        "background-color": "orange",
        "text-align": "center",
        "height": "40%",
        "width": "100%",
      });
      var value2 = $('<p>').addClass('value2').text('Value2').css({
        "display": "flexbox",
        "position": "relative",
        "top": "0%",
        "transform": "translateY(-50%)",
      });
      bar2.append(value2);

      var bar3 = $('<div>').addClass('bar3').css({
        "position": "absolute",
        "bottom": "0",
        "grid-area": "1/3/span 1/span 1",
        "background-color": "dodgerblue",
        "text-align": "center",
        "height": "60%",
        "width": "100%", //width relative to 
      });
      var value3 = $('<p>').addClass('value3').text('Value3').css({
        "display": "flexbox",
        "position": "relative",
        "top": "0%",
        "transform": "translateY(-50%)",
      });
      bar3.append(value3);

      chartArea.append(bar1, bar2, bar3);

      // append all the elements to the barChart container element
      barChart.append(title, yAxis, xAxis, chartArea);

      // append the barChart container element to the DOM
      $(element).append(barChart);

    }

    $(document).ready(drawBarChart(data, options, element));

  </script>